# LIS Backend Environment Configuration
# Version: 1.0.0
# Date: 2025-11-15
#
# IMPORTANT: Copy this file to .env and configure with your actual values
# DO NOT commit .env file to version control

# ============================================================================
# Database Configuration
# ============================================================================

# PostgreSQL Configuration
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=postgres

# Database URLs for each service
DATABASE_URL_PATIENT=postgresql://postgres:postgres@postgres:5432/lis_patient
DATABASE_URL_SAMPLE=postgresql://postgres:postgres@postgres:5432/lis_sample
DATABASE_URL_ORDER=postgresql://postgres:postgres@postgres:5432/lis_order
DATABASE_URL_RESULT=postgresql://postgres:postgres@postgres:5432/lis_result
DATABASE_URL_USER=postgresql://postgres:postgres@postgres:5432/lis_user
DATABASE_URL_ORGANIZATION=postgresql://postgres:postgres@postgres:5432/lis_organization
DATABASE_URL_EQUIPMENT=postgresql://postgres:postgres@postgres:5432/lis_equipment
DATABASE_URL_QC=postgresql://postgres:postgres@postgres:5432/lis_qc
DATABASE_URL_BILLING=postgresql://postgres:postgres@postgres:5432/lis_billing
DATABASE_URL_REPORT=postgresql://postgres:postgres@postgres:5432/lis_report
DATABASE_URL_INVENTORY=postgresql://postgres:postgres@postgres:5432/lis_inventory
DATABASE_URL_NOTIFICATION=postgresql://postgres:postgres@postgres:5432/lis_notification
DATABASE_URL_ANALYTICS=postgresql://postgres:postgres@postgres:5432/lis_analytics
DATABASE_URL_COMPLIANCE=postgresql://postgres:postgres@postgres:5432/lis_compliance
DATABASE_URL_SYNC=postgresql://postgres:postgres@postgres:5432/lis_sync
DATABASE_URL_FILE=postgresql://postgres:postgres@postgres:5432/lis_file
DATABASE_URL_INTEGRATION=postgresql://postgres:postgres@postgres:5432/lis_integration
DATABASE_URL_ABDM=postgresql://postgres:postgres@postgres:5432/lis_abdm

# ============================================================================
# Redis Configuration
# ============================================================================

REDIS_URL=redis://redis:6379
REDIS_PASSWORD=

# ============================================================================
# Kafka Configuration
# ============================================================================

KAFKA_BROKERS=kafka:9092
KAFKA_ENABLE_EVENTS=true

# ============================================================================
# MinIO (Object Storage) Configuration
# ============================================================================

MINIO_ENDPOINT=minio:9000
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
MINIO_USE_SSL=false
MINIO_BUCKET_NAME=lis-files

# ============================================================================
# WhatsApp Business API Configuration
# ============================================================================

# Get from: https://developers.facebook.com/apps/
WHATSAPP_API_URL=https://graph.facebook.com/v18.0
WHATSAPP_ACCESS_TOKEN=your_whatsapp_access_token_here
WHATSAPP_PHONE_NUMBER_ID=your_phone_number_id_here
WHATSAPP_BUSINESS_ACCOUNT_ID=your_business_account_id_here

# ============================================================================
# Twilio (SMS) Configuration
# ============================================================================

# Get from: https://www.twilio.com/console
TWILIO_ACCOUNT_SID=your_twilio_account_sid_here
TWILIO_AUTH_TOKEN=your_twilio_auth_token_here
TWILIO_PHONE_NUMBER=+1234567890

# ============================================================================
# SendGrid (Email) Configuration
# ============================================================================

# Get from: https://sendgrid.com/
SENDGRID_API_KEY=your_sendgrid_api_key_here
SENDGRID_FROM_EMAIL=noreply@yourlabdomain.com
SENDGRID_FROM_NAME=Your Lab Name

# ============================================================================
# Razorpay (Payment Gateway) Configuration
# ============================================================================

# Get from: https://dashboard.razorpay.com/
RAZORPAY_KEY_ID=rzp_test_your_key_id_here
RAZORPAY_KEY_SECRET=your_razorpay_key_secret_here
RAZORPAY_WEBHOOK_SECRET=your_razorpay_webhook_secret_here
RAZORPAY_MODE=test  # Change to 'live' for production

# ============================================================================
# Stripe (Payment Gateway) Configuration
# ============================================================================

# Get from: https://dashboard.stripe.com/
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# ============================================================================
# PayU (Payment Gateway) Configuration
# ============================================================================

PAYU_MERCHANT_KEY=your_payu_merchant_key_here
PAYU_MERCHANT_SALT=your_payu_merchant_salt_here
PAYU_MODE=test  # Change to 'live' for production

# ============================================================================
# GSTN (E-Invoice) Configuration
# ============================================================================

# Get from: https://einvoice1.gst.gov.in/
GSTN_API_URL=https://gsp.adaequare.com  # For production use GSP URL
GSTN_USERNAME=your_gstn_username_here
GSTN_PASSWORD=your_gstn_password_here
GSTIN=12ABCDE3456F1Z5  # Your 15-digit GSTIN number
GSTN_MODE=sandbox  # Change to 'production' for production

# ============================================================================
# ABDM (Ayushman Bharat) Configuration
# ============================================================================

# Get from: https://sandbox.abdm.gov.in/applications/
ABDM_GATEWAY_URL=https://dev.abdm.gov.in/gateway
ABDM_CLIENT_ID=your_abdm_client_id_here
ABDM_CLIENT_SECRET=your_abdm_client_secret_here
ABDM_HIP_ID=your_hip_id_here
ABDM_MODE=sandbox  # Change to 'production' for production

# ============================================================================
# Aadhaar Configuration
# ============================================================================

AADHAAR_API_URL=https://api.aadhaarbridge.com
AADHAAR_API_KEY=your_aadhaar_api_key_here

# ============================================================================
# JWT & Security Configuration
# ============================================================================

# IMPORTANT: Generate a strong random secret for production
# Use: openssl rand -base64 64
JWT_SECRET=your-very-secure-jwt-secret-change-in-production-please-use-openssl-rand-base64-64
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_EXPIRATION_DAYS=7

# Session Configuration
SESSION_SECRET=your-very-secure-session-secret-change-in-production
SESSION_TIMEOUT_MINUTES=60

# ============================================================================
# Application Configuration
# ============================================================================

# Environment
NODE_ENV=production
RUST_ENV=production
RUST_LOG=info

# API Gateway
API_GATEWAY_HOST=0.0.0.0
API_GATEWAY_PORT=8000
API_GATEWAY_RATE_LIMIT=100  # requests per minute

# Application URLs
APP_URL=https://yourlabdomain.com
API_URL=https://api.yourlabdomain.com
FRONTEND_URL=https://yourlabdomain.com

# ============================================================================
# Service Ports (default values - usually don't need to change)
# ============================================================================

PORT_PATIENT_SERVICE=8081
PORT_SAMPLE_SERVICE=8082
PORT_ORDER_SERVICE=8083
PORT_RESULT_SERVICE=8084
PORT_USER_SERVICE=8085
PORT_ORGANIZATION_SERVICE=8086
PORT_EQUIPMENT_SERVICE=8087
PORT_QC_SERVICE=8088
PORT_BILLING_SERVICE=8089
PORT_REPORT_SERVICE=8090
PORT_INVENTORY_SERVICE=8091
PORT_NOTIFICATION_SERVICE=8092
PORT_ANALYTICS_SERVICE=8093
PORT_COMPLIANCE_SERVICE=8094
PORT_SYNC_SERVICE=8095
PORT_FILE_SERVICE=8096
PORT_INTEGRATION_SERVICE=8097
PORT_ABDM_SERVICE=8098

# ============================================================================
# Feature Flags
# ============================================================================

ENABLE_CACHING=true
ENABLE_EVENTS=true
ENABLE_RATE_LIMITING=true
ENABLE_OFFLINE_SYNC=true
ENABLE_WHATSAPP=true
ENABLE_EMAIL=true
ENABLE_SMS=true
ENABLE_ABDM=true
ENABLE_GSTN_EINVOICE=true

# ============================================================================
# File Upload Configuration
# ============================================================================

MAX_FILE_SIZE_MB=50
ALLOWED_FILE_TYPES=pdf,jpg,jpeg,png,doc,docx,xls,xlsx
FILE_RETENTION_DAYS=2555  # ~7 years

# ============================================================================
# Sync Service Configuration
# ============================================================================

SYNC_INTERVAL_SECONDS=300  # 5 minutes
CONFLICT_RESOLUTION_STRATEGY=last_write_wins  # Options: last_write_wins, manual_resolution, server_wins, client_wins

# ============================================================================
# Integration Service Configuration
# ============================================================================

HL7_LISTENER_PORT=6661
ASTM_LISTENER_PORT=6662
MIRTH_URL=http://mirth:8080

# ============================================================================
# Monitoring Configuration
# ============================================================================

# Prometheus
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin  # CHANGE IN PRODUCTION

# Jaeger
JAEGER_UI_PORT=16686
JAEGER_OTLP_GRPC_PORT=4317
JAEGER_OTLP_HTTP_PORT=4318

# ============================================================================
# Backup Configuration
# ============================================================================

BACKUP_ENABLED=true
BACKUP_INTERVAL_HOURS=4
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=lis-backups
AWS_ACCESS_KEY_ID=your_aws_access_key_here
AWS_SECRET_ACCESS_KEY=your_aws_secret_key_here
AWS_REGION=ap-south-1  # Mumbai region

# ============================================================================
# Logging Configuration
# ============================================================================

LOG_LEVEL=info  # Options: trace, debug, info, warn, error
LOG_FORMAT=json  # Options: json, pretty
LOG_RETENTION_DAYS=90

# ============================================================================
# Performance Configuration
# ============================================================================

DATABASE_MAX_CONNECTIONS=32
DATABASE_MIN_CONNECTIONS=5
DATABASE_CONNECT_TIMEOUT=30
DATABASE_IDLE_TIMEOUT=600

# ============================================================================
# CORS Configuration
# ============================================================================

CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://yourlabdomain.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# ============================================================================
# Email Templates
# ============================================================================

EMAIL_TEMPLATES_DIR=./templates/email

# ============================================================================
# Organization Configuration
# ============================================================================

DEFAULT_ORGANIZATION_NAME=Your Lab Name
DEFAULT_ORGANIZATION_EMAIL=contact@yourlabdomain.com
DEFAULT_ORGANIZATION_PHONE=+91 1234567890
DEFAULT_ORGANIZATION_ADDRESS=Your Lab Address

# ============================================================================
# SMS Templates (for Twilio)
# ============================================================================

SMS_SENDER_ID=LABSMS  # 6-character sender ID for India

# ============================================================================
# Development / Testing (remove in production)
# ============================================================================

# Set to true only in development
ENABLE_GRAPHQL_PLAYGROUND=false  # Set to false in production
ENABLE_DEBUG_LOGGING=false
ENABLE_MOCK_PAYMENTS=false
ENABLE_MOCK_WHATSAPP=false
