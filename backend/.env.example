# =============================================================================
# LIS Modern Backend - Environment Configuration Template
# =============================================================================
# Copy this file to .env and update with your actual values
# NEVER commit .env files to version control

# =============================================================================
# ENVIRONMENT
# =============================================================================
ENVIRONMENT=development  # development, staging, production
NODE_ENV=development
RUST_LOG=info,sqlx=warn,actix_web=info

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-secure-password-here
POSTGRES_DB=postgres

# Database URLs for each service
DATABASE_URL_PATIENT=postgresql://postgres:your-secure-password-here@localhost:5432/lis_patient
DATABASE_URL_SAMPLE=postgresql://postgres:your-secure-password-here@localhost:5432/lis_sample
DATABASE_URL_ORDER=postgresql://postgres:your-secure-password-here@localhost:5432/lis_order
DATABASE_URL_RESULT=postgresql://postgres:your-secure-password-here@localhost:5432/lis_result
DATABASE_URL_USER=postgresql://postgres:your-secure-password-here@localhost:5432/lis_user
DATABASE_URL_ORGANIZATION=postgresql://postgres:your-secure-password-here@localhost:5432/lis_organization
DATABASE_URL_EQUIPMENT=postgresql://postgres:your-secure-password-here@localhost:5432/lis_equipment
DATABASE_URL_QC=postgresql://postgres:your-secure-password-here@localhost:5432/lis_qc
DATABASE_URL_BILLING=postgresql://postgres:your-secure-password-here@localhost:5432/lis_billing
DATABASE_URL_REPORT=postgresql://postgres:your-secure-password-here@localhost:5432/lis_report
DATABASE_URL_INVENTORY=postgresql://postgres:your-secure-password-here@localhost:5432/lis_inventory
DATABASE_URL_NOTIFICATION=postgresql://postgres:your-secure-password-here@localhost:5432/lis_notification
DATABASE_URL_ANALYTICS=postgresql://postgres:your-secure-password-here@localhost:5432/lis_analytics
DATABASE_URL_COMPLIANCE=postgresql://postgres:your-secure-password-here@localhost:5432/lis_compliance

# Database Connection Pool
DATABASE_MAX_CONNECTIONS=32
DATABASE_MIN_CONNECTIONS=5
DATABASE_CONNECT_TIMEOUT=30
DATABASE_IDLE_TIMEOUT=600
DATABASE_MAX_LIFETIME=1800

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_MAX_CONNECTIONS=10
REDIS_CONNECT_TIMEOUT=5
REDIS_DEFAULT_TTL=3600

# =============================================================================
# KAFKA CONFIGURATION
# =============================================================================
KAFKA_BROKERS=localhost:9092
KAFKA_GROUP_ID=lis-consumer-group
KAFKA_ENABLE_AUTO_COMMIT=true
KAFKA_SESSION_TIMEOUT=6000
KAFKA_AUTO_OFFSET_RESET=earliest

# =============================================================================
# MONGODB CONFIGURATION (for analytics/logs)
# =============================================================================
MONGODB_URL=mongodb://localhost:27017
MONGODB_DATABASE=lis_analytics
MONGODB_MAX_POOL_SIZE=10

# =============================================================================
# SERVICE PORTS
# =============================================================================
PORT_API_GATEWAY=8080
PORT_PATIENT_SERVICE=8081
PORT_SAMPLE_SERVICE=8082
PORT_ORDER_SERVICE=8083
PORT_RESULT_SERVICE=8084
PORT_USER_SERVICE=8085
PORT_ORGANIZATION_SERVICE=8086
PORT_EQUIPMENT_SERVICE=8087
PORT_QC_SERVICE=8088
PORT_BILLING_SERVICE=8089
PORT_REPORT_SERVICE=8090
PORT_INVENTORY_SERVICE=8091
PORT_NOTIFICATION_SERVICE=8092
PORT_ANALYTICS_SERVICE=8093
PORT_COMPLIANCE_SERVICE=8094

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
HOST=0.0.0.0
SERVER_WORKERS=4
REQUEST_TIMEOUT=30
MAX_REQUEST_SIZE=10485760  # 10MB
ENABLE_CORS=true
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization
CORS_MAX_AGE=3600

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-minimum-32-characters
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_EXPIRATION_DAYS=30
JWT_ALGORITHM=HS256

# Password hashing (Argon2)
ARGON2_MEMORY_COST=65536
ARGON2_TIME_COST=3
ARGON2_PARALLELISM=4

# API Keys (change in production)
API_KEY_SECRET=your-api-key-secret-change-this
ENCRYPTION_KEY=your-encryption-key-32-chars-minimum-length-required

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_CACHING=true
ENABLE_EVENTS=true
ENABLE_RATE_LIMITING=true
ENABLE_METRICS=true
ENABLE_TRACING=true
ENABLE_HEALTH_CHECKS=true
ENABLE_PLAYGROUND=false  # Disable in production

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_SIZE=20

# =============================================================================
# EXTERNAL API CONFIGURATION
# =============================================================================

# UIDAI (Aadhaar)
UIDAI_BASE_URL=https://resident.uidai.gov.in/v1
UIDAI_API_KEY=your-uidai-api-key
UIDAI_TIMEOUT_SECONDS=30
UIDAI_ENCRYPTION_CERTIFICATE_PATH=/path/to/uidai/cert.pem

# ABDM (Ayushman Bharat Digital Mission)
ABDM_BASE_URL=https://healthidsbx.abdm.gov.in/api/v1
ABDM_CLIENT_ID=your-abdm-client-id
ABDM_CLIENT_SECRET=your-abdm-client-secret
ABDM_TIMEOUT_SECONDS=30

# WhatsApp Business API
WHATSAPP_BASE_URL=https://graph.facebook.com/v18.0
WHATSAPP_PHONE_NUMBER_ID=your-phone-number-id
WHATSAPP_ACCESS_TOKEN=your-whatsapp-access-token
WHATSAPP_VERIFY_TOKEN=your-webhook-verify-token
WHATSAPP_WEBHOOK_SECRET=your-webhook-secret

# Razorpay Payment Gateway
RAZORPAY_BASE_URL=https://api.razorpay.com/v1
RAZORPAY_KEY_ID=your-razorpay-key-id
RAZORPAY_KEY_SECRET=your-razorpay-key-secret
RAZORPAY_WEBHOOK_SECRET=your-razorpay-webhook-secret

# NIC e-Invoice API
NIC_EINVOICE_BASE_URL=https://einv-apisandbox.nic.in
NIC_EINVOICE_USERNAME=your-nic-username
NIC_EINVOICE_PASSWORD=your-nic-password
NIC_EINVOICE_GSTIN=your-gstin

# SMS Gateway
SMS_GATEWAY_URL=https://api.your-sms-provider.com/v1
SMS_GATEWAY_API_KEY=your-sms-api-key
SMS_GATEWAY_SENDER_ID=LISMDN

# Email Service (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@domain.com
SMTP_PASSWORD=your-app-specific-password
SMTP_FROM_NAME=LIS Modern
SMTP_FROM_EMAIL=noreply@lismodern.com
SMTP_USE_TLS=true

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Prometheus
PROMETHEUS_PORT=9090
METRICS_ENABLED=true

# Jaeger Tracing
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831
JAEGER_SERVICE_NAME=lis-backend
JAEGER_SAMPLER_TYPE=probabilistic
JAEGER_SAMPLER_PARAM=0.1

# Sentry Error Tracking
SENTRY_DSN=your-sentry-dsn-url
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Logging
LOG_LEVEL=info
LOG_FORMAT=json  # json or pretty
LOG_OUTPUT=stdout  # stdout, file, or both
LOG_FILE_PATH=/var/log/lis/app.log
LOG_MAX_SIZE=100MB
LOG_MAX_BACKUPS=10
LOG_MAX_AGE_DAYS=30

# =============================================================================
# STORAGE & FILE UPLOADS
# =============================================================================

# Local Storage
UPLOAD_DIR=/var/lis/uploads
MAX_UPLOAD_SIZE=52428800  # 50MB
ALLOWED_FILE_TYPES=pdf,jpg,jpeg,png,doc,docx,xls,xlsx

# S3 Compatible Storage (MinIO/AWS S3)
S3_ENDPOINT=https://s3.amazonaws.com
S3_REGION=ap-south-1
S3_BUCKET=lis-modern-files
S3_ACCESS_KEY_ID=your-s3-access-key
S3_SECRET_ACCESS_KEY=your-s3-secret-key
S3_USE_SSL=true

# =============================================================================
# COMPLIANCE & AUDIT
# =============================================================================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=1825  # 5 years for NABL compliance
DATA_ENCRYPTION_AT_REST=true
ENABLE_PII_MASKING=true

# =============================================================================
# PERFORMANCE & OPTIMIZATION
# =============================================================================
ENABLE_QUERY_CACHING=true
CACHE_TTL_SECONDS=300
ENABLE_DATABASE_QUERY_LOGGING=false
SLOW_QUERY_THRESHOLD_MS=1000

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=90
BACKUP_STORAGE_PATH=/var/lis/backups

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================
DEV_MODE=true
MOCK_EXTERNAL_APIS=false
SEED_DATABASE=false
ENABLE_API_DOCS=true
API_DOCS_PATH=/api/docs

# =============================================================================
# PRODUCTION-SPECIFIC (Only in production environment)
# =============================================================================
# TLS/SSL
TLS_ENABLED=false
TLS_CERT_PATH=/etc/ssl/certs/server.crt
TLS_KEY_PATH=/etc/ssl/private/server.key

# Security Headers
ENABLE_HSTS=true
HSTS_MAX_AGE=31536000
ENABLE_CSP=true
CSP_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'

# Health Checks
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=5
HEALTH_CHECK_RETRIES=3

# Graceful Shutdown
SHUTDOWN_TIMEOUT_SECONDS=30

# =============================================================================
# NOTES
# =============================================================================
# 1. Change all 'your-*' placeholder values before deploying
# 2. Use strong, randomly generated passwords and secrets
# 3. Store production secrets in a secure vault (e.g., AWS Secrets Manager, HashiCorp Vault)
# 4. Rotate secrets regularly
# 5. Never commit .env files to version control
# 6. Use different values for development, staging, and production
# 7. Ensure minimum key lengths: JWT secret (32 chars), encryption key (32 chars)
# 8. Enable TLS in production
# 9. Disable GraphQL playground in production
# 10. Set appropriate CORS origins for production
